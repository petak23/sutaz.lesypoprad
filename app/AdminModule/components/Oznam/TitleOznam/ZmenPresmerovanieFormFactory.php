<?phpnamespace App\AdminModule\Components\Oznam\TitleOznam;use Nette\Application\UI\Form;use Nette\Utils\Html;use DbTable;/** * Formular a jeho spracovanie pre zmenu vlastnika polozky. * Posledna zmena 11.11.2016 *  * @author     Ing. Peter VOJTECH ml. <petak23@gmail.com> * @copyright  Copyright (c) 2012 - 2016 Ing. Peter VOJTECH ml. * @license * @link       http://petak23.echo-msz.eu * @version    1.0.0 */class ZmenPresmerovanieFormFactory {  /** @var DbTable\Hlavne_menu_lang */	private $hlavne_menu_lang;  /** @var DbTable\Udaje */	private $udaje;    /**   * @param DbTable\Hlavne_menu_lang $hlavne_menu_lang   * @param DbTable\Udaje $udaje */  public function __construct(DbTable\Hlavne_menu_lang $hlavne_menu_lang, DbTable\Udaje $udaje) {		$this->hlavne_menu_lang = $hlavne_menu_lang;    $this->udaje = $udaje;	}    /**   * Formular pre zmenu vlastnika polozky.   * @return Nette\Application\UI\Form */    public function create()  {    $presm = $this->udaje->getUdajInt('oznam_presmerovanie');		$form = new Form();		$form->addProtection();    $form->addHidden("kluc", "oznam_presmerovanie");    $form->addCheckbox("presmerovanie_not", " Presmerovanie nie je")         ->setDefaultValue($presm == 0 ? 1 : 0)         ->addCondition(Form::EQUAL, TRUE)         ->toggle("presmeruj", FALSE);    $form->addGroup()->setOption('container', Html::el('fieldset')->id("presmeruj"));    $form->addRadioList('clanok', 'NovÃ½ vlastnÃ­k:', $this->hlavne_menu_lang->findAll()->fetchPairs('id', 'nazov'))         ->setDefaultValue($presm == 0 ? 1 : $presm);    $form->setCurrentGroup(NULL);    $form->addSubmit('uloz', 'ZmeÅˆ')         ->setAttribute('class', 'btn btn-success')         ->onClick[] = [$this, 'zmenPresmerovanieFormSubmitted'];    $form->addSubmit('cancel', 'Cancel')         ->setAttribute('class', 'btn btn-default')         ->setAttribute('data-dismiss', 'modal')         ->setAttribute('aria-label', 'Close')         ->setValidationScope(FALSE);		return $form;	}    /**    * Spracovanie formulara pre zmenu vlastnika clanku.   * @param Nette\Forms\Controls\SubmitButton $button Data formulara */  public function zmenPresmerovanieFormSubmitted($button) {		$values = $button->getForm()->getValues(); 	//Nacitanie hodnot formulara    try {      $cl = $values->presmerovanie_not == 1 ? 0 : $values->clanok;			$this->udaje->opravKluc($values->kluc, $cl);		} catch (Database\DriverException $e) {			$button->addError($e->getMessage());		}  }}