<?phpnamespace App\AdminModule\Components\Clanky;use Nette;use DbTable;/** * Komponenta pre zobrazenie konkretneho clanku * Posledna zmena(last change): 04.03.2016 * * @author Ing. Peter VOJTECH ml <petak23@gmail.com> * @copyright Copyright (c) 2012 - 2016 Ing. Peter VOJTECH ml. * @license * @link http://petak23.echo-msz.eu * @version 1.0.9 */class ZobrazClanokControl extends Nette\Application\UI\Control {  /** @var DbTable\Hlavne_menu_lang */	public $hlavne_menu_lang;  /** @var int */  protected $id_hlavne_menu;  /** @var boolean $zobraz_anotaciu Zobrazenie anotacie polozky*/  private $zobraz_anotaciu;  /** @param DbTable\Hlavne_menu_lang $hlavne_menu_lang */     public function __construct(DbTable\Hlavne_menu_lang $hlavne_menu_lang) {    parent::__construct();    $this->hlavne_menu_lang = $hlavne_menu_lang;  }    /** Nastavenie komponenty   * @param int $id_hlavne_menu   * @param boolean $zobraz_anotaciu */  public function setZobraz($id_hlavne_menu, $zobraz_anotaciu = FALSE) {    $this->id_hlavne_menu = $id_hlavne_menu;    $this->zobraz_anotaciu = $zobraz_anotaciu;    return $this;  }    /** Render funkcia pre vypisanie odkazu na clanok    * @see Nette\Application\Control#render() */  public function render() {    $this->template->setFile(__DIR__ . "/ZobrazClanok.latte");    $this->template->cl_texts = $this->hlavne_menu_lang->findBy(["id_hlavne_menu"=> $this->id_hlavne_menu]);    $this->template->zobraz_anotaciu = $this->zobraz_anotaciu;    $this->template->render();  }     protected function createTemplate($class = NULL) {    $servise = $this;    $template = parent::createTemplate($class);    $template->addFilter('obr_v_txt', function ($text) use($servise){      $rozloz = explode("#", $text);      $serv = $servise->presenter;      $vysledok = '';      $cesta = 'http://'.$serv->nazov_stranky."/";      foreach ($rozloz as $k=>$cast) {        if (substr($cast, 0, 2) == "I-") {          $obr = $serv->dokumenty->find((int)substr($cast, 2));					if ($obr !== FALSE) {            $cast = \Nette\Utils\Html::el('a class="fotky"')->href($cesta.$obr->subor)->title($obr->nazov)                                  ->setHtml(\Nette\Utils\Html::el('img')->src($cesta.$obr->thumb)->alt($obr->nazov));					}        }        $vysledok .= $cast;      }      return $vysledok;    });    $template->addFilter('koncova_znacka', function ($text) use($servise){      $rozloz = explode("{end}", $text);      $vysledok = $text;			if (count($rozloz)>1) {		 //Ak som nasiel znacku				$vysledok = $rozloz[0].\Nette\Utils\Html::el('a class="cely_clanok"')->href($servise->link("this"))->title("Zobrazenie celého článku")                ->setHtml('&gt;&gt;&gt; viac').'<div class="ostatok">'.$rozloz[1].'</div>';			}      return $vysledok;    });    return $template;	}}interface IZobrazClanokControl {  /** @return ZobrazClanokControl */  function create();}