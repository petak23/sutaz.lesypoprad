<?phpnamespace App\AdminModule\Presenters;use Nette\Utils\Html;use DbTable;/** * Prezenter pre administraciu slider-u. *  * Posledna zmena(last change): 15.01.2016 * * Modul: ADMIN * * @author Ing. Peter VOJTECH ml. <petak23@gmail.com> * @copyright  Copyright (c) 2012 - 2016 Ing. Peter VOJTECH ml. * @license * @link       http://petak23.echo-msz.eu * @version 1.0.7a */class SliderPresenter extends \App\AdminModule\Presenters\BasePresenter {  /**    * @inject   * @var DbTable\Slider */  public $slider;  /** @var array Nastavenie slider-u */  private $slider_i;    /** @var Forms\Slider\EditSliderFormFactory @inject*/	public $editSliderForm;    protected function startup() {		parent::startup();		$nastavenie = $this->context->parameters;		if (isset($nastavenie['slider'])) {			$this->slider_i = $nastavenie['slider'];      $this->template->slider_i = $this->slider_i;		}	}  /** Render defaultnej akcie */  public function renderDefault() {    $this->template->tabulka = $this->slider->getSlider('id');	}  /** Akcia pre pridanie položky slideru */	public function actionAdd() {    $poradie = $this->slider->findAll()->max('poradie');    $this["sliderEditForm"]->setDefaults(['poradie' => isset($poradie) && $poradie ? (++$poradie) : 1]);    $this->template->sucasny = Html::el('img', array('width'=>'90', 'alt'=>'obrazok'))->src('http://'.$this->nazov_stranky.'/www/images/otaznik.png');    $this->setView('Edit');	}  /**   * Akcia pre editaciu polozky slider-u   * @param int $id id editovanej polozky   */	public function actionEdit($id) {    if (($pol_slider = $this->slider->find($id)) === FALSE) {      $this->setView('notFound');		} else {			$this->template->sucasny = Html::el('img', array('width'=>'90', 'alt'=>'obrazok'))										 ->src('http://'.$this->nazov_stranky.'/www/'.                      (is_file('www/files/slider/'.$pol_slider->subor) ? 'files/slider/'.$pol_slider->subor : 'images/otaznik.png'));			$this["sliderEditForm"]->setDefaults($pol_slider);      $this["sliderEditForm"]->setDefaults(array('zobrazenie_null' => ($pol_slider->zobrazenie==NULL) ? 1 : 0));    }	}	/** Edit Slider form component factory for admin.	 * @return Nette\Application\UI\Form	 */	public function createComponentSliderEditForm() {    $form = $this->editSliderForm->create($this->slider_i, $this->context->parameters['wwwDir']);      $form['uloz']->onClick[] = function ($button) {      $this->flashOut(!count($button->errors), 'Slider:', 'Položka bola uložená!', 'Došlo k chybe a adresa sa neuložila. Skúste neskôr znovu...');		};    $form['cancel']->onClick[] = function () {			$this->redirect('Slider:');		};		return $this->_vzhladForm($form);	}      /** Funkcia pre spracovanie signálu vymazavania	  * @param int $id - id polozky v hlavnom menu		* @param string $nazov - nazov polozky z hl. menu - na zrusenie?		* @param string $druh - blizsia specifikacia, kde je to potrebne		*/	function confirmedDelete($id, $nazov, $druh = "")	{    $temp_del = $this->slider->find($id);    if (is_file('www/files/slider/'.$temp_del->subor)) { unlink($this->context->parameters["wwwDir"]."/www/files/slider/".$temp_del->subor); }    $this->_ifMessage($temp_del->delete() == 1, 'Položka bola úspešne vymazaná!', 'Došlo k chybe a položka nebola vymazaná!');    $this->redirect('Slider:');  }}	